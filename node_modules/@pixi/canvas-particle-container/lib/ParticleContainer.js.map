{"version":3,"file":"ParticleContainer.js","sources":["../src/ParticleContainer.ts"],"sourcesContent":["import { ParticleContainer } from '@pixi/particle-container';\n\nimport type { CanvasRenderer } from '@pixi/canvas-renderer';\n\n/**\n * Renders the object using the Canvas renderer\n * @method renderCanvas\n * @memberof PIXI.ParticleContainer#\n * @private\n * @param {PIXI.CanvasRenderer} renderer - a reference to the canvas renderer\n */\nParticleContainer.prototype.renderCanvas = function renderCanvas(renderer: CanvasRenderer): void\n{\n    if (!this.visible || this.worldAlpha <= 0 || !this.children.length || !this.renderable)\n    {\n        return;\n    }\n\n    const context = renderer.canvasContext.activeContext;\n    const transform = this.worldTransform;\n    let isRotated = true;\n\n    let positionX = 0;\n    let positionY = 0;\n\n    let finalWidth = 0;\n    let finalHeight = 0;\n\n    renderer.canvasContext.setBlendMode(this.blendMode);\n\n    context.globalAlpha = this.worldAlpha;\n\n    this.displayObjectUpdateTransform();\n\n    for (let i = 0; i < this.children.length; ++i)\n    {\n        const child = this.children[i];\n\n        if (!child.visible)\n        {\n            continue;\n        }\n\n        if (!child._texture.valid)\n        {\n            continue;\n        }\n\n        const frame = child._texture.frame;\n\n        context.globalAlpha = this.worldAlpha * child.alpha;\n\n        if (child.rotation % (Math.PI * 2) === 0)\n        {\n            // this is the fastest  way to optimise! - if rotation is 0 then we can avoid any kind of setTransform call\n            if (isRotated)\n            {\n                renderer.canvasContext.setContextTransform(transform, false, 1);\n                isRotated = false;\n            }\n\n            positionX = ((child.anchor.x) * (-frame.width * child.scale.x)) + child.position.x + 0.5;\n            positionY = ((child.anchor.y) * (-frame.height * child.scale.y)) + child.position.y + 0.5;\n\n            finalWidth = frame.width * child.scale.x;\n            finalHeight = frame.height * child.scale.y;\n        }\n        else\n        {\n            if (!isRotated)\n            {\n                isRotated = true;\n            }\n\n            child.displayObjectUpdateTransform();\n\n            const childTransform = child.worldTransform;\n\n            renderer.canvasContext.setContextTransform(childTransform, this.roundPixels, 1);\n\n            positionX = ((child.anchor.x) * (-frame.width)) + 0.5;\n            positionY = ((child.anchor.y) * (-frame.height)) + 0.5;\n\n            finalWidth = frame.width;\n            finalHeight = frame.height;\n        }\n\n        const resolution = child._texture.baseTexture.resolution;\n        const contextResolution = renderer.canvasContext.activeResolution;\n\n        context.drawImage(\n            child._texture.baseTexture.getDrawableSource(),\n            frame.x * resolution,\n            frame.y * resolution,\n            frame.width * resolution,\n            frame.height * resolution,\n            positionX * contextResolution,\n            positionY * contextResolution,\n            finalWidth * contextResolution,\n            finalHeight * contextResolution\n        );\n    }\n};\n"],"names":["ParticleContainer"],"mappings":";;AAWAA,kBAAAA,kBAAkB,UAAU,eAAe,SAAsB,UACjE;AACQ,MAAA,CAAC,KAAK,WAAW,KAAK,cAAc,KAAK,CAAC,KAAK,SAAS,UAAU,CAAC,KAAK;AAExE;AAGJ,QAAM,UAAU,SAAS,cAAc,eACjC,YAAY,KAAK;AACnB,MAAA,YAAY,IAEZ,YAAY,GACZ,YAAY,GAEZ,aAAa,GACb,cAAc;AAET,WAAA,cAAc,aAAa,KAAK,SAAS,GAElD,QAAQ,cAAc,KAAK,YAE3B,KAAK,6BAA6B;AAElC,WAAS,IAAI,GAAG,IAAI,KAAK,SAAS,QAAQ,EAAE,GAC5C;AACU,UAAA,QAAQ,KAAK,SAAS,CAAC;AAO7B,QALI,CAAC,MAAM,WAKP,CAAC,MAAM,SAAS;AAEhB;AAGE,UAAA,QAAQ,MAAM,SAAS;AAE7B,QAAA,QAAQ,cAAc,KAAK,aAAa,MAAM,OAE1C,MAAM,YAAY,KAAK,KAAK,OAAO;AAG/B,oBAEA,SAAS,cAAc,oBAAoB,WAAW,IAAO,CAAC,GAC9D,YAAY,KAGhB,YAAc,MAAM,OAAO,KAAM,CAAC,MAAM,QAAQ,MAAM,MAAM,KAAM,MAAM,SAAS,IAAI,KACrF,YAAc,MAAM,OAAO,KAAM,CAAC,MAAM,SAAS,MAAM,MAAM,KAAM,MAAM,SAAS,IAAI,KAEtF,aAAa,MAAM,QAAQ,MAAM,MAAM,GACvC,cAAc,MAAM,SAAS,MAAM,MAAM;AAAA,SAG7C;AACS,oBAED,YAAY,KAGhB,MAAM,6BAA6B;AAEnC,YAAM,iBAAiB,MAAM;AAEpB,eAAA,cAAc,oBAAoB,gBAAgB,KAAK,aAAa,CAAC,GAE9E,YAAc,MAAM,OAAO,IAAM,CAAC,MAAM,QAAU,KAClD,YAAc,MAAM,OAAO,IAAM,CAAC,MAAM,SAAW,KAEnD,aAAa,MAAM,OACnB,cAAc,MAAM;AAAA,IACxB;AAEA,UAAM,aAAa,MAAM,SAAS,YAAY,YACxC,oBAAoB,SAAS,cAAc;AAEzC,YAAA;AAAA,MACJ,MAAM,SAAS,YAAY,kBAAkB;AAAA,MAC7C,MAAM,IAAI;AAAA,MACV,MAAM,IAAI;AAAA,MACV,MAAM,QAAQ;AAAA,MACd,MAAM,SAAS;AAAA,MACf,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,aAAa;AAAA,MACb,cAAc;AAAA,IAAA;AAAA,EAEtB;AACJ;"}